-- ACTIVAR BASE DE DATOS

USE ENCUESTA;
GO


-- OBJETOS DE LA BASE DE DATOS

CREATE TABLE dbo.TB_PARAMETRO
( 
	ID_PARAMETRO         integer  NOT NULL ,
	NOMBRE               varchar(100)  NOT NULL ,
	VALOR                varchar(100)  NOT NULL ,
	CONSTRAINT XPKTB_PARAMETRO PRIMARY KEY (ID_PARAMETRO ASC)
)
go



CREATE TABLE dbo.TB_ENCUESTA
( 
	ID_ENCUESTA          integer  NOT NULL ,
	INGRESO              integer  NOT NULL ,
	ESTADO               integer  NOT NULL ,
	CONSTRAINT XPKTB_ENCUESTA PRIMARY KEY (ID_ENCUESTA ASC)
)
go




EXEC sp_addextendedproperty
@name = N'MS_Description', @value = N'Numero de digitación, inicia con 1, 2, 3, ...',
@level0type = N'SCHEMA', @level0name = N'dbo',
@level1type = N'TABLE', @level1name = N'TB_ENCUESTA',
@level2type = N'COLUMN', @level2name = N'INGRESO'
go




EXEC sp_addextendedproperty
@name = N'MS_Description', @value = N'1: En Proceso
2: Ok
3: Error',
@level0type = N'SCHEMA', @level0name = N'dbo',
@level1type = N'TABLE', @level1name = N'TB_ENCUESTA',
@level2type = N'COLUMN', @level2name = N'ESTADO'
go



CREATE TABLE dbo.TB_ROL
( 
	ID_ROL               integer  NOT NULL ,
	NOMBRE               varchar(100)  NOT NULL ,
	CONSTRAINT XPKTB_ROL PRIMARY KEY (ID_ROL ASC)
)
go



CREATE TABLE dbo.TB_USUARIO
( 
	ID_USUARIO           integer  NOT NULL ,
	NOMBRE               varchar(100)  NOT NULL ,
	APELLIDO             varchar(100)  NOT NULL ,
	USUARIO              varchar(20)  NOT NULL ,
	CLAVE                varchar(20)  NOT NULL ,
	ID_ROL               integer  NOT NULL ,
	CONSTRAINT XPKTB_USUARIO PRIMARY KEY (ID_USUARIO ASC),
	CONSTRAINT FK_USUARIO_ROL FOREIGN KEY (ID_ROL) REFERENCES dbo.TB_ROL(ID_ROL)
		ON DELETE NO ACTION
		ON UPDATE NO ACTION
)
go



CREATE TABLE dbo.TB_BEBIDA
( 
	ID_BEBIDA            integer  NOT NULL ,
	NOMBRE               varchar(100)  NOT NULL ,
	CONSTRAINT XPKTB_BEBIDA PRIMARY KEY (ID_BEBIDA ASC)
)
go



CREATE TABLE TB_DISTRITO
( 
	ID_DISTRITO          integer  NOT NULL ,
	NOMBRE               varchar(100)  NOT NULL ,
	CONSTRAINT XPKTB_DISTRITO PRIMARY KEY (ID_DISTRITO ASC)
)
go



CREATE TABLE dbo.TB_DET_ENCUESTA
( 
	ID_ENCUESTA          integer  NOT NULL ,
	ID_USUARIO           integer  NOT NULL ,
	INGRESO              integer  NOT NULL ,
	SEXO                 char(1)  NOT NULL ,
	EDAD                 integer  NOT NULL ,
	ID_DISTRITO          integer  NOT NULL ,
	BEBIDA1              integer  NOT NULL ,
	BEBIDA2              integer  NOT NULL ,
	CONSTRAINT XPKTB_DET_ENCUESTA PRIMARY KEY (ID_ENCUESTA ASC,ID_USUARIO ASC),
	CONSTRAINT FK_DET_ENCUESTA_ENCUESTA FOREIGN KEY (ID_ENCUESTA) REFERENCES dbo.TB_ENCUESTA(ID_ENCUESTA)
		ON DELETE NO ACTION
		ON UPDATE NO ACTION,
CONSTRAINT FK_DET_ENCUESTA_USUARIO FOREIGN KEY (ID_USUARIO) REFERENCES dbo.TB_USUARIO(ID_USUARIO)
		ON DELETE NO ACTION
		ON UPDATE NO ACTION,
CONSTRAINT FK_DET_ENCUESTA_BEBIDA_01 FOREIGN KEY (BEBIDA1) REFERENCES dbo.TB_BEBIDA(ID_BEBIDA)
		ON DELETE NO ACTION
		ON UPDATE NO ACTION,
CONSTRAINT FK_DET_ENCUESTA_BEBIDA_02 FOREIGN KEY (BEBIDA2) REFERENCES dbo.TB_BEBIDA(ID_BEBIDA)
		ON DELETE NO ACTION
		ON UPDATE NO ACTION,
CONSTRAINT FK_DET_ENCUESTA_DISTRITO FOREIGN KEY (ID_DISTRITO) REFERENCES TB_DISTRITO(ID_DISTRITO)
		ON DELETE NO ACTION
		ON UPDATE NO ACTION
)
go



ALTER TABLE dbo.TB_DET_ENCUESTA
	ADD CONSTRAINT U_TB_DET_ENCUESTA UNIQUE (ID_ENCUESTA  ASC,INGRESO  ASC)
go




EXEC sp_addextendedproperty
@name = N'MS_Description', @value = N'Numero de digitación, inicia con 1, 2, 3, ...',
@level0type = N'SCHEMA', @level0name = N'dbo',
@level1type = N'TABLE', @level1name = N'TB_DET_ENCUESTA',
@level2type = N'COLUMN', @level2name = N'INGRESO'
go




EXEC sp_addextendedproperty
@name = N'MS_Description', @value = N'M: Masculino
F: Femenino',
@level0type = N'SCHEMA', @level0name = N'dbo',
@level1type = N'TABLE', @level1name = N'TB_DET_ENCUESTA',
@level2type = N'COLUMN', @level2name = N'SEXO'
go




-- DATOS

-- ROLES

INSERT INTO dbo.TB_ROL(ID_ROL, NOMBRE) VALUES( 1, 'DIGITADOR');
INSERT INTO dbo.TB_ROL(ID_ROL, NOMBRE) VALUES( 2, 'ADMINISTRADOR');
GO


-- USUARIOS

INSERT INTO dbo.TB_USUARIO(ID_USUARIO,NOMBRE,APELLIDO,USUARIO,CLAVE,ID_ROL)
VALUES(1,'JOSE','CASTRO','JCASTRO','123456',1);

INSERT INTO dbo.TB_USUARIO(ID_USUARIO,NOMBRE,APELLIDO,USUARIO,CLAVE,ID_ROL)
VALUES(2,'MARTHA','TORRES','MTORRES','123456',1);

INSERT INTO dbo.TB_USUARIO(ID_USUARIO,NOMBRE,APELLIDO,USUARIO,CLAVE,ID_ROL)
VALUES(3,'LEONOR','DIAZ','LDIAZ','123456',1);

INSERT INTO dbo.TB_USUARIO(ID_USUARIO,NOMBRE,APELLIDO,USUARIO,CLAVE,ID_ROL)
VALUES(4,'JUAN','TARAZONA','JTARAZONA','123456',2);

INSERT INTO dbo.TB_USUARIO(ID_USUARIO,NOMBRE,APELLIDO,USUARIO,CLAVE,ID_ROL)
VALUES(5,'PEDRO','MARRUFO','PMARRUFO','123456',1);

INSERT INTO dbo.TB_USUARIO(ID_USUARIO,NOMBRE,APELLIDO,USUARIO,CLAVE,ID_ROL)
VALUES(6,'ALEJANDRA','CUEVA','ACUEVA','123456',1);
GO

-- BEBIDA


INSERT INTO dbo.TB_BEBIDA(ID_BEBIDA,NOMBRE) VALUES(1,'BEBIDA 1');
INSERT INTO dbo.TB_BEBIDA(ID_BEBIDA,NOMBRE) VALUES(2,'BEBIDA 2');
INSERT INTO dbo.TB_BEBIDA(ID_BEBIDA,NOMBRE) VALUES(3,'BEBIDA 3');
INSERT INTO dbo.TB_BEBIDA(ID_BEBIDA,NOMBRE) VALUES(4,'BEBIDA 4');
INSERT INTO dbo.TB_BEBIDA(ID_BEBIDA,NOMBRE) VALUES(5,'BEBIDA 5');
INSERT INTO dbo.TB_BEBIDA(ID_BEBIDA,NOMBRE) VALUES(6,'BEBIDA 6');
INSERT INTO dbo.TB_BEBIDA(ID_BEBIDA,NOMBRE) VALUES(7,'BEBIDA 7');
GO


-- DISTRITO

INSERT INTO dbo.TB_DISTRITO(ID_DISTRITO,NOMBRE) VALUES(1,'DISTRITO 1');
INSERT INTO dbo.TB_DISTRITO(ID_DISTRITO,NOMBRE) VALUES(2,'DISTRITO 2');
INSERT INTO dbo.TB_DISTRITO(ID_DISTRITO,NOMBRE) VALUES(3,'DISTRITO 3');
INSERT INTO dbo.TB_DISTRITO(ID_DISTRITO,NOMBRE) VALUES(4,'DISTRITO 4');
INSERT INTO dbo.TB_DISTRITO(ID_DISTRITO,NOMBRE) VALUES(5,'DISTRITO 5');
INSERT INTO dbo.TB_DISTRITO(ID_DISTRITO,NOMBRE) VALUES(6,'DISTRITO 6');
INSERT INTO dbo.TB_DISTRITO(ID_DISTRITO,NOMBRE) VALUES(7,'DISTRITO 7');
GO


-- PARAMETROS

INSERT INTO dbo.TB_PARAMETRO( ID_PARAMETRO,NOMBRE,VALOR)
VALUES(1,'ESTADO DEL PROCESO','1');
GO


